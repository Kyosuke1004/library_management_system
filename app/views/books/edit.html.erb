<h1 class="title is-4 mb-4">図書情報の編集</h1>
<div class="box">
  <%= form_with(model: @book, local: true) do |f| %>
    <div class="field">
      <label class="label">タイトル</label>
      <div class="control">
        <%= f.text_field :title, class: "input" %>
      </div>
    </div>
    <div class="field">
      <label class="label">著者（既存：チェックで削除／新規：下の欄で追加）</label>
      <div>
        <% Author.all.each do |author| %>
          <label class="checkbox mr-2">
            <%= check_box_tag "book[author_ids][]", author.id, @book.author_ids.include?(author.id) %>
            <%= author.name %>
          </label>
        <% end %>
      </div>
    </div>
    <div class="field mt-2">
      <label class="label">新規著者（カンマ区切り・予測変換可）</label>
      <div class="control" style="position: relative;">
        <%= f.text_area :new_author_names, rows: 2, class: "input", id: "author-input", autocomplete: "off" %>
        <div id="author-suggestions"></div>
      </div>
    </div>
    <div class="field">
      <label class="label">出版社</label>
      <div class="control">
        <%= f.text_field :publisher, class: "input" %>
      </div>
    </div>
    <div class="field">
      <label class="label">出版年</label>
      <div class="control">
        <%= f.text_field :published_year, class: "input" %>
      </div>
    </div>
    <div class="field">
      <label class="label">ISBN</label>
      <div class="control">
        <%= f.text_field :isbn, class: "input" %>
      </div>
    </div>
    <div class="field is-grouped mt-4">
      <div class="control">
        <%= f.submit "更新", class: "button is-success is-dark" %>
      </div>
      <div class="control">
        <%= link_to "戻る", book_path(@book), class: "button is-ghost" %>
      </div>
    </div>
  <% end %>
</div>